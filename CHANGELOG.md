# 更改日志

所有对本项目的重要更改都将记录在本文件中，按倒序排列，最新版本在顶部。

## [Version 1.3.0] - 2026-01-29

### 重构 (Refactor)
- **静态化重构**:
  - **移除后端依赖**: 前端全面移除对后端 API 的动态请求，适配纯静态部署环境。
  - **模拟数据层**: 重构 Service 层 (`authService`, `userService`, `skillsService` 等)，使用本地 Mock 数据和静态 JSON 文件替代后端接口。

### 新增 (Added)
- **数据生成工具**: 新增 Python 脚本 `scripts/generate_skills_json.py`，用于扫描 `skills` 目录下的 `SKILL.md` 文件，解析 Frontmatter 元数据并生成 `public/skills.json`，作为静态模式下的数据源。

### 变更 (Changed)
- **构建配置**: 修改 Vite 配置，移除 API 代理设置，确保构建产物可独立运行。

## [Version 1.2.7] - 2026-01-29

### 移除 (Removed)
- **需求文档模块**: 移除侧边栏“需求文档”入口及相关页面代码 (`/requirement-docs`)，精简系统功能。

## [Version 1.2.6] - 2026-01-28

### 修复 (Fixed)
- **认证系统**: 修复登录时提示 `401 Unauthorized` 的问题（恢复默认管理员账号数据）。
- **构建系统**: 修复前端构建时的未使用变量引用错误。

### 优化 (Optimized)
- **Skill 编辑器**:
  - **布局优化**: 基础信息与外观设置区域采用响应式 Grid 布局，减少页面纵向空间占用。
  - **交互微调**: 将“随机/自定义”外观切换开关移至“外观设置”标题栏右侧，视觉层级更清晰。

## [Version 1.2.5] - 2026-01-28

### 优化 (Optimized)
- **Skill 编辑器体验升级**:
  - **智能外观**: 新增“随机外观”模式，新建 Skill 时默认随机生成图标与主题色，支持一键切换回“自定义”模式。
  - **自动标签**: 引入智能标签提取功能，当 Markdown 内容变更时，自动提炼并推荐 Top 5 关键词作为标签 (支持防抖与停用词过滤)。
  - **交互优化**: 
    - 优化了外观设置区域的 UI 布局，操作更加直观。
    - **双栏布局**: 调整编辑器布局为左右双栏模式。左侧集成基础信息表单与 Markdown 编辑器，右侧实时展示预览效果，提升写作时的对照体验。

## [Version 1.2.4] - 2026-01-28

### 变更 (Changed)
- **附件管理升级**:
  - **上传限制**: 创建 Skill 时限制仅允许上传 1 个附件（新文件自动覆盖旧文件）。
  - **删除机制**:
    - 用户侧：`Delete` 操作调整为软删除 (Soft Delete)，数据保留但不可见。
    - 管理侧：新增“彻底删除”功能，物理删除 Skill 及其关联的附件文件。
  - **清理工具**: 新增附件一键清理页面 (`/admin/cleanup`)，用于清理未关联的孤儿附件。

## [Version 1.2.3] - 2026-01-28

### 新增 (Added)
- **附件管理系统**:
  - **上传功能**: Skill 编辑页支持上传附件（支持 PDF, Word, Zip, Markdown 等格式，最大 10MB）。
  - **下载功能**: Skill 详情页展示附件列表，支持一键下载。
  - **后端支持**: 新增 `UploadModule` 实现文件存储与静态资源服务，采用 UUID 命名避免冲突。
  - **数据关联**: 升级 `Skill` 模型，支持与 `Attachment` 的一对多关联。

## [Version 1.2.2] - 2026-01-27

### 优化 (Optimized)
- **个人中心 (Profile)**:
  - 新增“我的 Skills”展示区块，支持以卡片形式查看我发布的所有 Skill。
  - 增加 Skill 状态角标（审核中/已拒绝），方便用户实时了解作品状态。
  - 优化空状态展示，提供快捷发布入口。
- **首页 (Home)**:
  - 优化交互逻辑，未登录用户不再显示“发布 Skill”按钮，引导用户先登录。
- **后端 (Backend)**:
  - 修复 `findByUser` 接口权限逻辑，确保作者可以查看自己所有状态（包括待审核/已拒绝）的 Skill，而他人只能查看已发布的 Skill。
  - 完善 Skill 审核流程的自动化验证脚本 (`verify_audit_flow.ts`)。

## [Version 1.2.1] - 2026-01-27

### 新增 (Added)
- **Skill 审核系统**:
  - **状态管理**: 引入 `Pending` (待审核)、`Approved` (已发布)、`Rejected` (已拒绝) 三种状态。
  - **发布流程**: 用户发布的 Skill 默认为待审核状态，需管理员审核通过后才在首页公开展示。
  - **管理后台**: 新增管理员专属的审核页面 (`/admin/skills`)，支持批量查看、通过或拒绝 Skill。
  - **状态反馈**:
    - **列表页**: Skill 卡片增加状态角标 (仅对自己可见)。
    - **详情页**: 详情页增加醒目的状态提示横幅 (Banner)。
  - **权限控制**: 仅管理员可访问审核接口和页面；普通用户只能查看自己的非发布状态 Skill。

## [Version 1.2.0] - 2026-01-27

### 新增 (Added)
- **Skills 高级功能**:
  - **创建与编辑**: 新增 Skill 编辑器页面 (`/skill/create`, `/skill/:id/edit`)，支持 Markdown 实时预览、标签管理、图标与颜色自定义。
  - **互动系统**:
    - **评论功能**: 详情页新增评论发布与展示列表。
    - **评分功能**: 支持 1-5 星交互式评分，并在详情页实时展示平均分。
  - **权限与个人中心**:
    - **归属权校验**: 实现后端权限控制，仅作者本人可编辑或删除其发布的 Skill。
    - **个人中心**: Profile 页面新增“我发布的 Skills”列表，方便用户管理自己的作品。
  - **入口优化**: 首页新增“发布 Skill”入口。
- **后端 (Backend)**:
  - **数据模型**: 新增 `Comment` 和 `Rating` 模型 (Prisma Schema)。
  - **API 升级**: 
    - 完善 Skills CRUD 接口，支持全量/增量更新。
    - 新增评论 (`POST /skills/:id/comments`) 和评分 (`POST /skills/:id/ratings`) 接口。
    - 新增用户作品查询 (`GET /skills/user/:userId`) 接口。
    - 实现评分平均值自动计算逻辑。

## [Version 1.1.2] - 2026-01-27

### 新增 (Added)
- **认证模块**:
  - **注册功能**: 新增用户注册页面 (`/register`) 与后端接口 (`/auth/register`)，支持新用户创建账号并自动登录。
  - **用户服务**: 创建 `userService.ts`，封装用户 CRUD 接口，对接真实后端数据。
- **页面功能**:
  - **用户管理**: `TenantUsersPage` 完成真实 API 对接，支持用户列表分页展示、姓名/邮箱搜索、角色筛选及删除用户操作。
  - **个人中心**: `Profile` 页面对接真实 API，展示当前登录用户的真实姓名、角色及组织信息。

### 优化 (Optimized)
- **前端架构**: 完善前端 Service 层封装，统一管理 API 请求。
- **用户体验**: 注册成功后自动存储 Token 并跳转至首页，无需二次登录。

## [Version 1.1.1] - 2026-01-27

### 安全 (Security)
- **认证模块升级**:
  - **密码哈希**: 后端启用 `bcrypt` 算法对用户密码进行加密存储与验证，彻底告别明文密码。
  - **Seed 数据**: 更新数据库 Seed 脚本，确保初始管理员账户 (`admin@example.com`) 密码经过哈希处理。
  - **前端对接**: 登录页 (`Login`) 废除 `setTimeout` 模拟逻辑，全面对接真实 `/auth/login` 接口。
  - **Token 管理**: 实现登录成功后 `access_token` 的本地持久化存储 (`localStorage`)。

### 新增
- **前端服务**:
  - **AuthService**: 新增 `authService.ts`，封装登录 (`login`)、获取用户信息 (`getProfile`) 和登出 (`logout`) 接口。

## [Version 1.1.0] - 2026-01-27

### 里程碑 (Milestone)
- **Skills 模块全栈贯通**: 完成 Skills 核心业务模块的前后端分离改造。
  - **数据持久化**: Skills 数据从前端 Mock 迁移至 SQLite 数据库。
  - **API 对接**: 首页与详情页完全对接真实后端 API。

### 新增
- **后端 (Backend)**:
  - **Skills 模块**:
    - 设计 `Skill` 和 `Tag` 数据库模型 (Prisma Schema)。
    - 实现 Skills 的 CRUD 接口 (Controller & Service)。
    - 编写 Seed 脚本，将现有的 9 个 Mock Skills 及其 Markdown 内容完整迁移至数据库。
    - 启用全局路由前缀 `/api`。
- **前端 (Frontend)**:
  - **SkillsService**: 封装 `findAll` 和 `findOne` 接口调用。
  - **首页 (Home)**: 改造为异步获取真实 Skill 列表，支持 Loading 状态。
  - **详情页 (SkillDetail)**: 改造为根据 ID 异步获取 Skill 详情，优化 Markdown 渲染。

### 优化
- **开发体验**:
  - 修复后端模块 (Roles, Tenants, Users) 的 import 路径错误。
  - 优化前端 API 代理配置，确保 `/api` 请求正确转发至后端服务。

## [Version 1.0.75] - 2026-01-27

### 修复
- **主题切换**: 修复了 Tailwind CSS v4 下深色模式切换不生效的问题。
  - 原因：Tailwind CSS v4 默认使用媒体查询策略，需在 CSS 中显式声明类名变体。
  - 解决：在 `index.css` 中添加 `@variant dark (&:where(.dark, .dark *));` 配置。

## [Version 1.0.74] - 2026-01-27

### 新增
- **导航栏功能 (Navbar Features)**:
  - **主题切换**: 实现深色/浅色/跟随系统的主题切换下拉菜单 (Dropdown)，支持持久化存储。
  - **通知中心**: 实现通知气泡 (Popover)，展示模拟的通知列表，支持“全部已读”和点击跳转功能。
  - **全局命令面板**: 集成 `cmdk` 实现全局命令面板 (Command Palette)，支持 `Ctrl+K` / `Cmd+K` 快捷键唤起。
  - **全局搜索**: 支持通过命令面板搜索页面导航（首页、指南、关于等）和热门 Skills，并支持快速切换主题。

## [Version 1.0.73] - 2026-01-27

### 新增
- **关于页面 (About)**:
  - **全新设计**: 参照 Guide 页面风格，重构了 `/about` 页面。
  - **丰富内容**: 新增了“使命愿景”、“核心价值” (Cards Grid)、“平台数据” (Stats Banner) 和“核心团队” (Team) 板块。
  - **视觉升级**: 引入渐变色文字、毛玻璃效果卡片、Lucide 图标以及响应式布局，提升品牌质感。

### 优化
- **UI 交互**:
  - **全局滚动条**: 优化了全局滚动条样式（Webkit内核），使其更细（6px）、颜色更浅且支持 hover 加深效果，提升页面视觉清爽度。
  - **About 页面**: 
    - 优化了响应式布局和移动端适配。
    - 新增 **飞书** 联系方式，支持直接唤起飞书 App 或打开网页版。
    - 优化 GitHub、Twitter、Email 按钮的点击反馈（暂未开放提示）。

## [Version 1.0.72] - 2026-01-27

### 优化
- **UI 体验**:
  - **标签筛选**: 优化首页标签筛选的选中状态样式。将原来的“深色背景+白色文字”调整为“浅橙色背景+深橙色文字”（暗黑模式下为半透明背景），显著提升了文字的可读性和视觉舒适度。

## [Version 1.0.71] - 2026-01-27

### 优化
- **导航栏优化**:
  - **界面精简**: 移除顶部导航栏最右上角的用户卡片区域（包含头像、姓名、角色），使界面更加简洁。

## [Version 1.0.70] - 2026-01-27

### 新增
- **Skills 内容扩充**:
  - **新增 Skill**: 代码格式转换 (Code Format Converter), PDF 智能提取 (PDF Smart Extractor), 全网舆情监控 (Web Sentiment Monitor), 网站安全扫描 (Website Security Scan)。
  - **真实内容**: 为上述 Skill 补充了详细的 Markdown 文档，包含简介、功能特性、快速开始代码示例和最佳实践。
  - **数据更新**: 更新 `skillsData.ts` 以引用新增的 Markdown 内容，丰富了首页的展示效果。

## [Version 1.0.69] - 2026-01-27

### 新增
- **Skills 分享站**:
  - **详情页**: 实现 `/skill/:id` 详情页面，支持 Markdown 格式的内容渲染。
  - **路由关联**: 打通首页 Skills 卡片点击跳转至详情页的路由逻辑。
  - **热门榜单**: 更新 Charts 页面，支持点击榜单卡片跳转至详情页。
