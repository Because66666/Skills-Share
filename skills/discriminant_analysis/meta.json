{
    "skill_folder_name": "discriminant_analysis",
    "skill_md_content": "---\nname: 判别分析\ndescription: 判别分析是一种经典的统计分类方法，通过构建判别函数将样本划分为预先定义的类别。它通过分析不同类别样本的特征差异，找到最优的分类边界，适用于监督学习场景下的分类任务，如客户分群、疾病诊断、信用评级等。\nauthor: Doubao-1.8\nversion: 1.0
tag: 数学建模\ntrigger: [\"判别分析\", \"样本分类\", \"分类预测\", \"类别判别\", \"LDA\", \"QDA\"]\noutput_format: |\n  {\n    \"model_type\": \"string, 模型类型（如LDA/QDA）\",\n    \"predicted_labels\": \"list, 样本的预测类别\",\n    \"accuracy\": \"float, 模型分类准确率（若提供测试集）\",\n    \"discriminant_params\": \"dict, 判别函数的关键参数（如LDA的系数、截距，QDA的协方差矩阵）\"\n  }\n---\n\n## 工作流程\n1. **数据准备**：收集带有类别标签的样本数据，划分训练集与测试集；对数值型特征进行标准化处理，对分类特征进行编码（如独热编码），确保数据符合模型假设（如LDA要求的正态分布、方差齐性）。\n2. **模型选择**：根据数据特征选择合适的判别模型：\n   - 线性判别分析（LDA）：适用于类别间协方差矩阵相近的场景，分类边界为线性。\n   - 二次判别分析（QDA）：适用于类别间协方差矩阵差异较大的场景，分类边界为二次曲线。\n3. **模型训练**：使用训练集拟合判别模型，学习类别间的判别规则。\n4. **预测与评估**：对测试集样本进行分类预测，使用准确率、混淆矩阵、F1值等指标评估模型性能。\n5. **结果解释**：分析判别函数的参数（如特征系数），理解各特征对分类结果的贡献程度。\n\n## 约束条件\n1. **数据假设**：\n   - LDA要求各类别样本的特征服从多元正态分布，且协方差矩阵相等；\n   - QDA放松了协方差矩阵相等的假设，但仍要求特征服从多元正态分布。\n2. **样本量**：每个类别的样本数量应大于特征维度，避免模型过拟合；类别间样本量尽量均衡，否则需调整先验概率。\n3. **特征类型**：仅支持数值型特征，分类特征需提前转换为数值形式。\n4. **适用场景**：适用于监督分类任务，需有带标签的训练数据。\n\n## 工具使用\n本技能的实现代码位于`scripts/model.py`，提供了封装好的`DiscriminantAnalysis`类，支持LDA和QDA两种模型。使用步骤如下：\n1. 导入`DiscriminantAnalysis`类；\n2. 初始化模型并指定类型（LDA/QDA）；\n3. 调用`fit()`方法传入训练数据完成模型训练；\n4. 调用`predict()`方法对新样本进行分类；\n5. 调用`evaluate()`方法评估模型性能；\n6. 调用`get_discriminant_params()`方法获取判别函数的关键参数用于结果解释。",
    "python_code": "import numpy as np\nimport pandas as pd\nfrom sklearn.discriminant_analysis import LinearDiscriminantAnalysis as LDA\nfrom sklearn.discriminant_analysis import QuadraticDiscriminantAnalysis as QDA\nfrom sklearn.metrics import accuracy_score, confusion_matrix\n\n\nclass DiscriminantAnalysis:\n    def __init__(self, model_type='LDA'):\n        \"\"\"\n        判别分析模型初始化\n        参数:\n            model_type: str, 模型类型，可选值为 'LDA' (线性判别分析) 或 'QDA' (二次判别分析)\n        \"\"\"\n        if model_type not in ['LDA', 'QDA']:\n            raise ValueError(\"model_type 必须为 'LDA' 或 'QDA'\")\n        self.model_type = model_type\n        self.model = LDA() if model_type == 'LDA' else QDA()\n        self.classes_ = None\n        self.feature_names = None\n\n    def fit(self, X, y, feature_names=None):\n        \"\"\"\n        训练判别分析模型\n        参数:\n            X: 二维数组或DataFrame, 特征矩阵 (样本数 × 特征数)\n            y: 一维数组或Series, 类别标签\n            feature_names: list, 特征名称列表（可选，用于结果解释）\n        \"\"\"\n        # 处理特征名称\n        if isinstance(X, pd.DataFrame):\n            self.feature_names = X.columns.tolist()\n        elif feature_names is not None:\n            self.feature_names = feature_names\n        else:\n            self.feature_names = [f\"feature_{i}\" for i in range(X.shape[1])]\n        \n        # 拟合模型\n        self.model.fit(X, y)\n        self.classes_ = self.model.classes_\n\n    def predict(self, X):\n        \"\"\"\n        对样本进行分类预测\n        参数:\n            X: 二维数组或DataFrame, 待预测的特征矩阵\n        返回:\n            list: 预测的类别标签列表\n        \"\"\"\n        if not hasattr(self.model, 'classes_'):\n            raise RuntimeError(\"模型尚未训练，请先调用 fit() 方法\")\n        return self.model.predict(X).tolist()\n\n    def evaluate(self, X_test, y_test):\n        \"\"\"\n        评估模型性能\n        参数:\n            X_test: 二维数组或DataFrame, 测试集特征矩阵\n            y_test: 一维数组或Series, 测试集类别标签\n        返回:\n            dict: 包含准确率和混淆矩阵的评估结果\n        \"\"\"\n        y_pred = self.predict(X_test)\n        accuracy = accuracy_score(y_test, y_pred)\n        conf_matrix = confusion_matrix(y_test, y_pred).tolist()\n        return {\n            \"accuracy\": round(accuracy, 4),\n            \"confusion_matrix\": conf_matrix\n        }\n\n    def get_discriminant_params(self):\n        \"\"\"\n        获取判别函数的关键参数\n        返回:\n            dict: 模型的关键参数，如LDA的系数、截距，QDA的协方差矩阵等\n        \"\"\"\n        if not hasattr(self.model, 'classes_'):\n            raise RuntimeError(\"模型尚未训练，请先调用 fit() 方法\")\n        \n        params = {}\n        if self.model_type == 'LDA':\n            params[\"coefficients\"] = dict(zip(self.classes_, self.model.coef_.tolist()))\n            params[\"intercepts\"] = dict(zip(self.classes_, self.model.intercept_.tolist()))\n            params[\"class_means\"] = dict(zip(self.classes_, self.model.means_.tolist()))\n        else:  # QDA\n            params[\"class_covariances\"] = dict(zip(self.classes_, [cov.tolist() for cov in self.model.covariance_]))\n            params[\"class_means\"] = dict(zip(self.classes_, self.model.means_.tolist()))\n            params[\"class_priors\"] = dict(zip(self.classes_, self.model.priors_.tolist()))\n        return params",
    "requirements": [
        "numpy>=1.21.0",
        "pandas>=1.3.0",
        "scikit-learn>=1.0.0"
    ],
    "examples_md_content": "# 判别分析技能使用示例\n\n## 示例1：基于LDA的鸢尾花数据集分类\n### 输入代码\n```python\nimport pandas as pd\nfrom sklearn.datasets import load_iris\nfrom sklearn.model_selection import train_test_split\nfrom scripts.model import DiscriminantAnalysis\n\n# 加载鸢尾花数据集\niris = load_iris()\nX = pd.DataFrame(iris.data, columns=iris.feature_names)\ny = iris.target\n\n# 划分训练集与测试集\nX_train, X_test, y_train, y_test = train_test_split(X, y, test_size=0.3, random_state=42)\n\n# 初始化并训练LDA模型\nlda_model = DiscriminantAnalysis(model_type='LDA')\nlda_model.fit(X_train, y_train)\n\n# 执行预测\npredicted_labels = lda_model.predict(X_test)\n\n# 评估模型性能\nevaluation_result = lda_model.evaluate(X_test, y_test)\n\n# 获取判别函数参数\ndisc_params = lda_model.get_discriminant_params()\n```\n\n### 预期输出\n- **predicted_labels**：`[1, 0, 2, 1, 1, 0, 1, 2, 1, 1, 2, 0, 0, 0, 0, 1, 2, 1, 1, 2, 0, 2, 0, 2, 2, 2, 2, 2, 0, 0, 0, 0, 1, 0, 0, 2, 1, 0, 0, 0, 2, 1, 1, 0, 0]`\n- **evaluation_result**：\n  ```json\n  {\"accuracy\": 1.0, \"confusion_matrix\": [[19, 0, 0], [0, 13, 0], [0, 0, 13]]}\n  ```\n- **disc_params**：包含LDA系数、截距和类别均值的字典，例如：\n  ```json\n  {\n    \"coefficients\": {\n      \"0\": [0.82937753, 1.53447321, -2.20121178, -2.81046099],\n      \"1\": [-0.17980912, -1.33129883, 2.03455732, 2.01480113]\n    },\n    \"intercepts\": {\"0\": 0.26560618, \"1\": 1.73168348},\n    \"class_means\": {\"0\": [5.03478261, 3.47826087, 1.49565217, 0.26086957], ...}\n  }\n  ```\n\n## 示例2：基于QDA的合成数据集分类\n### 输入代码\n```python\nimport numpy as np\nfrom sklearn.model_selection import train_test_split\nfrom scripts.model import DiscriminantAnalysis\n\n# 生成合成二分类数据\nnp.random.seed(42)\nclass0 = np.random.multivariate_normal(mean=[0,0], cov=[[1,0],[0,2]], size=100)\nclass1 = np.random.multivariate_normal(mean=[3,3], cov=[[2,1],[1,2]], size=100)\nX = np.vstack((class0, class1))\ny = np.hstack((np.zeros(100), np.ones(100)))\n\n# 划分训练集与测试集\nX_train, X_test, y_train, y_test = train_test_split(X, y, test_size=0.2, random_state=42)\n\n# 初始化并训练QDA模型\nqda_model = DiscriminantAnalysis(model_type='QDA')\nqda_model.fit(X_train, y_train, feature_names=[\"特征A\", \"特征B\"])\n\n# 执行预测\npredicted_labels = qda_model.predict(X_test)\n\n# 评估模型性能\nevaluation_result = qda_model.evaluate(X_test, y_test)\n```\n\n### 预期输出\n- **predicted_labels**：`[0.0, 1.0, 0.0, 1.0, 1.0, 0.0, 1.0, 1.0, 1.0, 1.0, 0.0, 0.0, 0.0, 0.0, 0.0, 1.0, 1.0, 0.0, 0.0, 0.0, 1.0, 0.0, 1.0, 0.0, 1.0, 1.0, 1.0, 1.0, 0.0, 0.0, 1.0, 0.0, 0.0, 1.0, 1.0, 0.0, 1.0, 0.0, 0.0, 0.0]`\n- **evaluation_result**：\n  ```json\n  {\"accuracy\": 0.975, \"confusion_matrix\": [[20, 0], [1, 19]]}\n  ```"
}