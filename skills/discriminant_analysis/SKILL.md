---
name: 判别分析
description: 判别分析是一种经典的统计分类方法，通过构建判别函数将样本划分为预先定义的类别。它通过分析不同类别样本的特征差异，找到最优的分类边界，适用于监督学习场景下的分类任务，如客户分群、疾病诊断、信用评级等。
author: Doubao-1.8
version: 1.0
tag: 数学建模
trigger: ["判别分析", "样本分类", "分类预测", "类别判别", "LDA", "QDA"]
output_format: |
  {
    "model_type": "string, 模型类型（如LDA/QDA）",
    "predicted_labels": "list, 样本的预测类别",
    "accuracy": "float, 模型分类准确率（若提供测试集）",
    "discriminant_params": "dict, 判别函数的关键参数（如LDA的系数、截距，QDA的协方差矩阵）"
  }
---

## 工作流程
1. **数据准备**：收集带有类别标签的样本数据，划分训练集与测试集；对数值型特征进行标准化处理，对分类特征进行编码（如独热编码），确保数据符合模型假设（如LDA要求的正态分布、方差齐性）。
2. **模型选择**：根据数据特征选择合适的判别模型：
   - 线性判别分析（LDA）：适用于类别间协方差矩阵相近的场景，分类边界为线性。
   - 二次判别分析（QDA）：适用于类别间协方差矩阵差异较大的场景，分类边界为二次曲线。
3. **模型训练**：使用训练集拟合判别模型，学习类别间的判别规则。
4. **预测与评估**：对测试集样本进行分类预测，使用准确率、混淆矩阵、F1值等指标评估模型性能。
5. **结果解释**：分析判别函数的参数（如特征系数），理解各特征对分类结果的贡献程度。

## 约束条件
1. **数据假设**：
   - LDA要求各类别样本的特征服从多元正态分布，且协方差矩阵相等；
   - QDA放松了协方差矩阵相等的假设，但仍要求特征服从多元正态分布。
2. **样本量**：每个类别的样本数量应大于特征维度，避免模型过拟合；类别间样本量尽量均衡，否则需调整先验概率。
3. **特征类型**：仅支持数值型特征，分类特征需提前转换为数值形式。
4. **适用场景**：适用于监督分类任务，需有带标签的训练数据。

## 工具使用
本技能的实现代码位于`scripts/model.py`，提供了封装好的`DiscriminantAnalysis`类，支持LDA和QDA两种模型。使用步骤如下：
1. 导入`DiscriminantAnalysis`类；
2. 初始化模型并指定类型（LDA/QDA）；
3. 调用`fit()`方法传入训练数据完成模型训练；
4. 调用`predict()`方法对新样本进行分类；
5. 调用`evaluate()`方法评估模型性能；
6. 调用`get_discriminant_params()`方法获取判别函数的关键参数用于结果解释。