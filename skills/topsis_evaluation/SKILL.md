---
name: TOPSIS评价法
description: TOPSIS（Technique for Order Preference by Similarity to Ideal Solution）即优劣解距离法，是一种常用的多指标综合评价方法，通过计算各评价对象与最优解、最劣解的相对距离来确定其优劣排序。
author: 数学建模助手
version: 1.0
tag: 数学建模
trigger: ["TOPSIS", "优劣解距离法", "多指标综合评价", "TOPSIS评价"]
output_format: >
  JSON格式，包含以下字段：
  - closeness_scores: 各评价对象的贴近度得分列表
  - ranking: 各评价对象的排名（从高到低）
  - ideal_solution: 正理想解
  - negative_ideal_solution: 负理想解
---

## 工作流程
1. **构建决策矩阵**：收集各评价对象的多指标数据，形成初始决策矩阵。
2. **标准化决策矩阵**：对决策矩阵进行归一化处理，消除指标量纲差异。
3. **加权标准化矩阵**：将标准化矩阵与各指标权重相乘，得到加权后的矩阵。
4. **确定正负理想解**：分别找出各指标的最优值（正理想解）和最劣值（负理想解）。
5. **计算距离**：计算每个评价对象到正理想解和负理想解的欧氏距离。
6. **计算贴近度并排序**：根据距离计算各对象的贴近度得分，得分越高排名越靠前。

## 约束条件
1. 所有评价指标必须为量化数据，不能包含定性指标（需预先量化处理）。
2. 需明确区分正向指标（数值越大越好）和负向指标（数值越小越好）。
3. 指标权重需合理分配，可通过层次分析法、熵权法等方法确定，权重之和应为1。
4. 决策矩阵中不能存在缺失值，需预先完成数据清洗。

## 工具使用
本方法的Python实现位于`scripts/model.py`，可通过调用`topsis_evaluation`函数进行计算。函数参数包括决策矩阵、指标权重、指标类型标识，返回包含贴近度得分、排名等结果的字典。