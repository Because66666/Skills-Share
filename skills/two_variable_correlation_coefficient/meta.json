{
    "skill_folder_name": "two_variable_correlation_coefficient",
    "skill_md_content": "---\nname: 两个变量间的相关系数计算\ndescription: 计算两个连续变量之间的皮尔逊相关系数，衡量变量间的线性相关程度和方向，并输出对应的统计显著性p值。\nauthor: Doubao-1.8\nversion: 1.0.0\ntrigger: 当需要分析两个连续变量的线性相关性、判断变量间关联强度时，调用此技能。\noutput_format: JSON格式，包含相关系数值（保留4位小数）、p值（保留4位小数）以及样本量信息。\n---\n\n## Workflow\n1. 数据准备：收集两个连续型数值变量的样本数据，确保数据完整（无缺失值）或已完成缺失值处理（如删除、插补）。\n2. 工具调用：使用`scripts/model.py`中的计算函数，输入两个变量的数据集。\n3. 结果分析：根据输出的相关系数（范围-1到1）判断相关方向和强度，结合p值判断相关性的统计显著性（通常p<0.05视为显著）。\n\n## Constraints\n- 适用变量类型：仅适用于连续型数值变量，分类变量或有序变量需转换或使用其他相关分析方法。\n- 数据分布假设：皮尔逊相关系数假设数据服从正态分布，若数据严重偏离正态分布，结果可能存在偏差。\n- 缺失值处理：输入数据不能包含缺失值（NaN），需提前处理。\n- 极端值影响：极端值可能显著改变相关系数结果，建议先进行异常值检测和处理。\n\n## Tool Usage\n相关系数的计算实现位于`scripts/model.py`，可通过调用其中的`calculate_correlation`函数完成。该函数接受两个数值型列表或numpy数组作为输入参数，返回包含相关系数、p值和样本量的字典结果。",
    "python_code": "import numpy as np\nfrom scipy.stats import pearsonr\n\ndef calculate_correlation(x, y):\n    \"\"\"\n    计算两个变量之间的皮尔逊相关系数和对应的p值\n    \n    参数:\n    x (list或numpy.ndarray): 第一个连续变量的样本数据\n    y (list或numpy.ndarray): 第二个连续变量的样本数据\n    \n    返回:\n    dict: 包含以下键值对的字典\n        - correlation_coefficient: 皮尔逊相关系数（保留4位小数）\n        - p_value: 相关性的统计显著性p值（保留4位小数）\n        - sample_size: 参与计算的有效样本量\n    \n    异常:\n    ValueError: 当输入数据包含非数值型元素、缺失值、或两个变量样本量不一致时抛出\n    \"\"\"\n    # 转换为numpy数组并处理非数值型元素\n    try:\n        x_arr = np.array(x, dtype=np.float64)\n        y_arr = np.array(y, dtype=np.float64)\n    except ValueError as e:\n        raise ValueError(\"输入数据中包含非数值型元素，请确保所有元素为数值\") from e\n    \n    # 检查样本量是否一致\n    if len(x_arr) != len(y_arr):\n        raise ValueError(\"两个变量的样本数量必须一致\")\n    \n    # 检查是否存在缺失值\n    if np.isnan(x_arr).any() or np.isnan(y_arr).any():\n        raise ValueError(\"输入数据中存在缺失值，请先处理缺失值\")\n    \n    # 计算皮尔逊相关系数和p值\n    r, p_value = pearsonr(x_arr, y_arr)\n    \n    return {\n        \"correlation_coefficient\": round(r, 4),\n        \"p_value\": round(p_value, 4),\n        \"sample_size\": len(x_arr)\n    }",
    "requirements": [
        "numpy",
        "scipy"
    ],
    "examples_md_content": "## 示例1：完美正相关场景\n### 输入\n```python\nx = [1, 2, 3, 4, 5, 6, 7]\ny = [2, 4, 6, 8, 10, 12, 14]\n```\n### 调用方式\n```python\nfrom scripts.model import calculate_correlation\nresult = calculate_correlation(x, y)\n```\n### 预期输出\n```json\n{\n    \"correlation_coefficient\": 1.0,\n    \"p_value\": 0.0,\n    \"sample_size\": 7\n}\n```\n### 说明\n相关系数为1.0，p值接近0，表明两个变量存在完美的强正线性相关关系。\n\n## 示例2：强负相关场景\n### 输入\n```python\nx = [10, 8, 6, 4, 2, 1]\ny = [1, 3, 5, 7, 9, 10]\n```\n### 调用方式\n```python\nresult = calculate_correlation(x, y)\n```\n### 预期输出\n```json\n{\n    \"correlation_coefficient\": -0.9978,\n    \"p_value\": 0.0001,\n    \"sample_size\": 6\n}\n```\n### 说明\n相关系数接近-1，p值远小于0.05，表明两个变量存在显著的强负线性相关关系。\n\n## 示例3：无显著相关场景\n### 输入\n```python\nx = [1, 2, 3, 4, 5]\ny = [5, 3, 1, 4, 2]\n```\n### 调用方式\n```python\nresult = calculate_correlation(x, y)\n```\n### 预期输出\n```json\n{\n    \"correlation_coefficient\": -0.1,\n    \"p_value\": 0.8239,\n    \"sample_size\": 5\n}\n```\n### 说明\n相关系数接近0，p值大于0.05，表明两个变量不存在显著的线性相关关系。\n\n## 示例4：含缺失值的错误场景\n### 输入\n```python\nx = [1, 2, None, 4, 5]\ny = [2, 4, 6, 8, 10]\n```\n### 调用方式\n```python\nresult = calculate_correlation(x, y)\n```\n### 预期结果\n抛出`ValueError`异常，提示信息：\"输入数据中存在缺失值，请先处理缺失值\"\n"
}