{
    "skill_folder_name": "time_series_white_noise_test",
    "skill_md_content": "---\nname: 时间序列白噪声检验\ndescription: 用于检验时间序列数据是否为白噪声的数学建模方法，通过统计量判断序列是否包含可提取的有效信息，是时间序列分析的前置基础步骤。\nauthor: Doubao-1.8\nversion: 1.0.0\ntrigger: 当需要判断时间序列数据是否为白噪声时触发该技能\noutput_format: JSON格式，包含是否为白噪声的布尔结果、Ljung-Box统计量、p值、自相关系数、偏自相关系数等关键指标\n---\n\n## 工作流程\n1. **数据输入与验证**：接收一维时间序列数据，检查数据维度与缺失值情况\n2. **统计量计算**：计算序列的自相关系数（ACF）和偏自相关系数（PACF）\n3. **Ljung-Box检验**：执行Ljung-Box白噪声检验，获取各滞后阶数的统计量与p值\n4. **结果判断**：根据p值（默认显著性水平0.05）判断序列是否为白噪声\n5. **结果输出**：返回检验结论及所有相关统计指标\n\n## 约束条件\n- 输入数据必须为一维时间序列，不支持多维或非时序格式数据\n- 输入数据不能包含缺失值，需提前完成缺失值处理\n- 样本量建议不少于20，否则检验结果的可靠性会显著降低\n- 本技能仅完成白噪声判断，不涉及时间序列的预测、分解等其他分析任务\n\n## 工具使用\n本技能的Python实现位于`scripts/model.py`，可调用其中的`white_noise_test`函数完成时间序列白噪声检验。函数支持numpy数组或pandas Series作为输入，返回包含完整检验结果的字典。",
    "python_code": "import numpy as np\nimport pandas as pd\nimport statsmodels.api as sm\nfrom statsmodels.stats.diagnostic import acorr_ljungbox\n\ndef white_noise_test(ts_data, max_lag=None):\n    \"\"\"\n    时间序列白噪声检验函数\n    参数:\n        ts_data: 一维时间序列数据，支持numpy数组或pandas Series\n        max_lag: 最大滞后阶数，默认取min(20, len(ts_data)//10)\n    返回:\n        dict: 包含检验结果的字典，键包括：\n            - is_white_noise: bool，是否为白噪声（基于p值>0.05判断）\n            - ljung_box_stat: 各滞后阶数的Ljung-Box统计量列表\n            - ljung_box_pvalues: 各滞后阶数的p值列表\n            - acf_values: 自相关系数列表（包含lag0）\n            - pacf_values: 偏自相关系数列表（包含lag0）\n            - max_lag: 实际使用的最大滞后阶数\n    \"\"\"\n    # 数据格式转换与验证\n    if isinstance(ts_data, pd.Series):\n        ts = ts_data.values\n    elif isinstance(ts_data, np.ndarray):\n        if ts_data.ndim != 1:\n            raise ValueError(\"输入数据必须为一维数组或Series\")\n        ts = ts_data\n    else:\n        raise TypeError(\"输入数据类型不支持，请传入numpy数组或pandas Series\")\n    \n    # 检查缺失值\n    if np.isnan(ts).any():\n        raise ValueError(\"输入数据包含缺失值，请处理后再进行检验\")\n    \n    n = len(ts)\n    # 设置默认最大滞后阶数\n    if max_lag is None:\n        max_lag = min(20, n // 10)\n    if max_lag < 1:\n        max_lag = 1\n    \n    # 计算自相关系数和偏自相关系数\n    acf_values = sm.tsa.acf(ts, nlags=max_lag, fft=False)\n    pacf_values = sm.tsa.pacf(ts, nlags=max_lag)\n    \n    # 执行Ljung-Box检验\n    lb_result = acorr_ljungbox(ts, lags=max_lag, return_df=True)\n    \n    # 判断是否为白噪声：所有滞后阶数的p值均大于0.05则认为是白噪声\n    is_white_noise = all(lb_result['lb_pvalue'] > 0.05)\n    \n    return {\n        \"is_white_noise\": is_white_noise,\n        \"ljung_box_stat\": lb_result['lb_stat'].tolist(),\n        \"ljung_box_pvalues\": lb_result['lb_pvalue'].tolist(),\n        \"acf_values\": acf_values.tolist(),\n        \"pacf_values\": pacf_values.tolist(),\n        \"max_lag\": max_lag\n    }",
    "requirements": [
        "numpy",
        "pandas",
        "statsmodels"
    ],
    "examples_md_content": "# 时间序列白噪声检验使用示例\n\n## 示例1：白噪声序列检验\n### 输入\n```python\nimport numpy as np\nfrom scripts.model import white_noise_test\n\n# 生成标准正态分布的白噪声序列\nnp.random.seed(42)\nwhite_noise_data = np.random.normal(0, 1, 100)\nresult = white_noise_test(white_noise_data)\n```\n### 预期输出\n```json\n{\n    \"is_white_noise\": true,\n    \"ljung_box_stat\": [0.063, 0.147, 0.301, 0.302, 0.313, 1.134, 1.134, 1.215, 1.220, 2.267],\n    \"ljung_box_pvalues\": [0.801, 0.929, 0.959, 0.989, 0.998, 0.953, 0.981, 0.986, 0.994, 0.973],\n    \"acf_values\": [1.0, -0.025, 0.030, 0.039, 0.000, 0.004, -0.128, 0.000, 0.020, -0.001, -0.143],\n    \"pacf_values\": [1.0, -0.025, 0.031, 0.040, -0.002, 0.005, -0.131, 0.012, 0.022, -0.015, -0.128],\n    \"max_lag\": 10\n}\n```\n\n## 示例2：非白噪声序列检验（AR(1)序列）\n### 输入\n```python\nimport numpy as np\nfrom scripts.model import white_noise_test\n\n# 生成AR(1)序列：x_t = 0.8*x_{t-1} + ε_t\nnp.random.seed(42)\nepsilon = np.random.normal(0, 1, 100)\nar_data = [0]\nfor i in range(1, 100):\n    ar_data.append(0.8 * ar_data[i-1] + epsilon[i])\nar_data = np.array(ar_data)\nresult = white_noise_test(ar_data)\n```\n### 预期输出\n```json\n{\n    \"is_white_noise\": false,\n    \"ljung_box_stat\": [25.671, 26.118, 26.120, 26.127, 26.215, 26.222, 26.433, 26.504, 26.510, 26.514],\n    \"ljung_box_pvalues\": [3.01e-07, 1.18e-06, 5.83e-06, 2.28e-05, 7.81e-05, 2.38e-04, 6.17e-04, 1.43e-03, 3.02e-03, 5.87e-03],\n    \"acf_values\": [1.0, 0.782, 0.613, 0.489, 0.389, 0.313, 0.253, 0.201, 0.165, 0.133, 0.109],\n    \"pacf_values\": [1.0, 0.820, 0.034, -0.013, 0.021, 0.047, 0.015, -0.020, 0.051, -0.007, 0.020],\n    \"max_lag\": 10\n}\n```"
}