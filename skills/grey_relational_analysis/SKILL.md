---
name: 灰色关联分析
description: 灰色关联分析是一种用于分析不完全信息系统中各因素之间关联程度的量化分析方法，适用于样本量少、数据信息不足的场景，能够有效揭示因素间的主次关系。
author: 数学建模助手
version: 1.0
tag: 数学建模
trigger: 当需要分析多个影响因素与目标因素之间的关联程度，且数据样本量较小或信息不完全时，触发该技能。
output_format: |
  {
    "relational_degrees": {"因素1": 关联度值, "因素2": 关联度值, ...},
    "rankings": ["因素1", "因素2", ...]  # 按关联度从高到低排序
  }
---

## 工作流程
1. **数据预处理**：对原始数据进行无量纲化处理，消除指标间的量纲差异，常用方法包括均值化、初值化、区间化等，根据指标类型（越大越好、越小越好、适中越好）选择合适的归一化方式。
2. **确定参考序列**：选择反映系统行为特征的最优序列作为参考序列，通常为目标因素的归一化数据。
3. **计算灰色关联系数**：根据各比较序列与参考序列的差值，结合分辨系数计算关联系数。
4. **计算灰色关联度**：对各因素的关联系数进行平均，得到该因素与参考序列的关联度。
5. **关联度排序**：根据关联度大小对各影响因素进行排序，关联度越大说明与目标因素的关联程度越高。

## 约束条件
1. 输入数据应为非负数值型数据，无缺失值；
2. 参考序列需为反映系统最优状态的序列，通常选择目标指标的归一化数据；
3. 归一化方法需根据指标的性质（正向指标、负向指标、适度指标）合理选择；
4. 分辨系数通常取0.5，可根据实际情况调整（范围0-1）。

## 工具使用
本技能的Python实现位于`scripts/model.py`，提供了`grey_relational_analysis`函数，可直接调用进行灰色关联分析。函数支持输入DataFrame或numpy数组，自动处理数据归一化、关联系数计算及关联度排序。