{
    "skill_folder_name": "mathematical_programming_modeling",
    "skill_md_content": "---\nname: 数学规划建模\ndescription: 用于构建和求解各类数学规划问题（包括线性规划、整数规划、非线性规划等）的建模工具，支持定义目标函数、约束条件并求解最优解。\nauthor: Doubao-1.8\nversion: 1.0
tag: 数学建模\ntrigger:\n  - \"进行数学规划建模\"\n  - \"求解优化问题\"\n  - \"构建线性规划模型\"\n  - \"寻找最优解\"\noutput_format: |\n  {\n    \"model_type\": \"string, 模型类型（如线性规划、整数规划）\",\n    \"objective_function\": \"string, 目标函数表达式\",\n    \"constraints\": [\"string, 约束条件列表\"],\n    \"optimal_solution\": {\"variable_name\": value},\n    \"optimal_value\": number,\n    \"status\": \"string, 求解状态（如最优解找到、无可行解等）\"\n  }\n---\n\n## 工作流程\n1. **问题定义**：明确优化目标（最大化/最小化）、决策变量及其含义。\n2. **模型构建**：\n   - 定义决策变量的类型（连续、整数、二进制）和取值范围。\n   - 编写目标函数的数学表达式。\n   - 列出所有约束条件（等式或不等式）。\n3. **模型求解**：调用求解器对构建好的数学规划模型进行求解。\n4. **结果分析**：解析求解结果，验证最优解的合理性，输出决策建议。\n\n## 约束条件\n- 必须明确目标函数的优化方向（最大化或最小化）。\n- 决策变量的类型和取值范围需清晰定义（如非负约束、整数约束等）。\n- 约束条件需符合数学逻辑，确保模型存在可行解或能被求解器处理。\n- 对于非线性规划问题，需确保目标函数和约束条件的可微性（部分求解器要求）。\n\n## 工具使用\n本技能的核心实现位于 `scripts/model.py`，提供了封装好的类 `MathematicalProgrammingModel`，支持快速构建各类数学规划模型并调用求解器求解。用户可通过该类的方法添加变量、设置目标函数、添加约束条件，并执行求解操作。",
    "python_code": "import pulp as lp\n\nclass MathematicalProgrammingModel:\n    \"\"\"\n    数学规划建模类，支持构建和求解线性规划、整数规划等各类数学规划问题\n    \"\"\"\n    def __init__(self, problem_name=\"math_programming_model\", sense=lp.LpMaximize):\n        \"\"\"\n        初始化模型\n        :param problem_name: 模型名称\n        :param sense: 优化方向，lp.LpMaximize（最大化）或 lp.LpMinimize（最小化）\n        \"\"\"\n        self.problem = lp.LpProblem(problem_name, sense)\n        self.variables = {}\n        self.status = None\n        self.optimal_value = None\n        self.optimal_solution = {}\n\n    def add_variable(self, name, var_type=lp.LpContinuous, lowBound=0, upBound=None):\n        \"\"\"\n        添加决策变量\n        :param name: 变量名称\n        :param var_type: 变量类型，lp.LpContinuous（连续）、lp.LpInteger（整数）、lp.LpBinary（二进制）\n        :param lowBound: 变量下界（默认0）\n        :param upBound: 变量上界（默认无限制）\n        :return: 创建的变量对象\n        \"\"\"\n        var = lp.LpVariable(name, lowBound=lowBound, upBound=upBound, cat=var_type)\n        self.variables[name] = var\n        return var\n\n    def set_objective(self, expr):\n        \"\"\"\n        设置目标函数\n        :param expr: 目标函数表达式（使用已添加的变量构建）\n        \"\"\"\n        self.problem += expr\n\n    def add_constraint(self, expr, name=None):\n        \"\"\"\n        添加约束条件\n        :param expr: 约束条件表达式（使用已添加的变量构建）\n        :param name: 约束名称（可选）\n        \"\"\"\n        self.problem += expr, name\n\n    def solve(self, solver=None):\n        \"\"\"\n        求解模型\n        :param solver: 指定求解器（默认使用CBC求解器）\n        :return: 求解状态、最优值、最优解\n        \"\"\"\n        self.status = self.problem.solve(solver=solver)\n        self.optimal_value = lp.value(self.problem.objective)\n        self.optimal_solution = {name: lp.value(var) for name, var in self.variables.items()}\n        return self.status, self.optimal_value, self.optimal_solution\n\n    def get_results(self):\n        \"\"\"\n        获取结构化的求解结果\n        :return: 包含模型信息和求解结果的字典\n        \"\"\"\n        # 推断模型类型\n        var_types = set(var.cat for var in self.variables.values())\n        if lp.LpInteger in var_types or lp.LpBinary in var_types:\n            model_type = \"整数规划\"\n        else:\n            model_type = \"线性规划\"\n\n        return {\n            \"model_type\": model_type,\n            \"objective_function\": str(self.problem.objective),\n            \"constraints\": [str(constraint) for constraint in self.problem.constraints.values()],\n            \"optimal_solution\": self.optimal_solution,\n            \"optimal_value\": self.optimal_value,\n            \"status\": lp.LpStatus[self.status]\n        }",
    "requirements": [
        "pulp",
        "numpy",
        "pandas"
    ],
    "examples_md_content": "# 数学规划建模使用示例\n\n## 示例1：线性规划 - 生产计划优化\n### 问题描述\n某工厂生产A、B两种产品，生产每件A产品获利3元，B产品获利2元。生产A产品需要1单位原料和2单位工时，B产品需要1单位原料和1单位工时。现有原料4单位，工时5单位。求如何安排生产使利润最大化。\n\n### 调用代码\n```python\nfrom scripts.model import MathematicalProgrammingModel\nimport pulp as lp\n\n# 初始化最大化模型\nmodel = MathematicalProgrammingModel(\"生产计划优化\", sense=lp.LpMaximize)\n\n# 添加连续决策变量x（A产品数量）、y（B产品数量）\nx = model.add_variable(\"x\")\ny = model.add_variable(\"y\")\n\n# 设置目标函数：max 3x + 2y\nmodel.set_objective(3 * x + 2 * y)\n\n# 添加约束条件\nmodel.add_constraint(x + y <= 4, \"原料总量约束\")\nmodel.add_constraint(2 * x + y <= 5, \"工时总量约束\")\n\n# 求解模型\nmodel.solve()\n\n# 获取结果\nresults = model.get_results()\nprint(results)\n```\n\n### 预期输出\n```json\n{\n  \"model_type\": \"线性规划\",\n  \"objective_function\": \"3*x + 2*y\",\n  \"constraints\": [\"x + y <= 4\", \"2*x + y <= 5\"],\n  \"optimal_solution\": {\"x\": 1.0, \"y\": 3.0},\n  \"optimal_value\": 9.0,\n  \"status\": \"Optimal\"\n}\n```\n\n## 示例2：整数规划 - 设备采购优化\n### 问题描述\n某公司需要采购设备，设备A单价10万，每年产生5万利润；设备B单价15万，每年产生7万利润。预算为40万，求采购多少台A和B设备使年利润最大化（设备数量为整数）。\n\n### 调用代码\n```python\nfrom scripts.model import MathematicalProgrammingModel\nimport pulp as lp\n\n# 初始化最大化模型\nmodel = MathematicalProgrammingModel(\"设备采购优化\", sense=lp.LpMaximize)\n\n# 添加整数决策变量a（A设备数量）、b（B设备数量）\na = model.add_variable(\"a\", var_type=lp.LpInteger)\nb = model.add_variable(\"b\", var_type=lp.LpInteger)\n\n# 设置目标函数：max 5a +7b\nmodel.set_objective(5 * a +7 * b)\n\n# 添加预算约束\nmodel.add_constraint(10 * a +15 * b <=40, \"预算约束\")\n\n# 求解模型\nmodel.solve()\n\n# 获取结果\nresults = model.get_results()\nprint(results)\n```\n\n### 预期输出\n```json\n{\n  \"model_type\": \"整数规划\",\n  \"objective_function\": \"5*a +7*b\",\n  \"constraints\": [\"10*a +15*b <=40\"],\n  \"optimal_solution\": {\"a\": 1, \"b\": 2},\n  \"optimal_value\": 19.0,\n  \"status\": \"Optimal\"\n}\n```"
}