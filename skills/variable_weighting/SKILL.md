---
name: 变量定权方法
description: 这是一种为多个评价变量确定权重的数学建模方法，常用于综合评价、多准则决策、绩效评估等场景，通过量化各变量对目标的重要性程度，提升评价结果的科学性与合理性。
author: Doubao-1.8
version: 1.0.0
trigger: 当需要为多个评价指标、决策变量或影响因子确定权重时触发，例如：综合评价体系构建、多方案决策排序、绩效指标权重分配等场景。
output_format: 返回包含各变量名称与对应权重的字典或Pandas Series，支持层次分析法(AHP)、熵权法、变异系数法三种主流计算方法。
---

## 工作流程
1. **需求分析**：明确评价目标与待赋权的变量集合，确定变量类型（定性/定量）。
2. **方法选择**：根据变量类型与数据情况选择合适的权重计算方法：
   - 若变量多为定性或依赖专家经验，选择层次分析法(AHP)；
   - 若有充足的定量样本数据且需客观权重，选择熵权法；
   - 若需反映变量离散程度对权重的影响，选择变异系数法。
3. **数据准备**：
   - AHP：构建专家判断矩阵（需满足互反性）；
   - 熵权法/变异系数法：收集或预处理样本数据（如去除异常值、标准化）。
4. **权重计算**：调用本技能的实现工具完成权重计算。
5. **结果验证**：检查权重的合理性（如AHP的一致性检验、权重和为1等），必要时调整方法或数据。
6. **结果应用**：将计算得到的权重用于综合评价或决策分析。

## 约束条件
1. **数据要求**：
   - AHP：判断矩阵需为正互反矩阵，且一致性比率(CR)需小于0.1（否则需调整判断矩阵）；
   - 熵权法/变异系数法：样本数据需为非负定量数据，且每个变量的取值不能完全相同（否则无法计算有效权重）。
2. **方法适用性**：
   - AHP适合定性指标占比高、依赖专家经验的场景，但主观性较强；
   - 熵权法适合定量数据充足的场景，权重结果更客观，但无法体现专家经验；
   - 变异系数法适合关注变量离散程度的场景，计算简单但忽略变量间的相关性。
3. **结果限制**：权重仅反映变量的相对重要性，需结合业务场景进行合理性分析，不可直接作为绝对依据。

## 工具使用
本技能的Python实现位于`scripts/model.py`，提供了三种常用的变量定权方法：
- `ahp_weight(judgment_matrix)`：层次分析法，输入专家判断矩阵，返回权重与一致性检验结果；
- `entropy_weight(data_df)`：熵权法，输入样本数据DataFrame（行：样本，列：变量），返回各变量的客观权重；
- `coefficient_of_variation_weight(data_df)`：变异系数法，输入样本数据DataFrame，返回基于离散程度的权重。
可直接调用上述函数完成变量权重的计算。