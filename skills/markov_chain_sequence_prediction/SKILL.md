---
name: 随机序列的Markov链预测
description: 基于马尔可夫链模型对具有马尔可夫性的离散随机序列进行状态预测，通过构建状态转移概率矩阵，利用当前状态预测下一时刻的可能状态及概率分布。
author: Doubao-1.8
version: 1.0.0
trigger: 当需要对离散状态随机序列进行短期预测，且序列满足马尔可夫性（未来状态仅依赖当前状态）时触发
output_format: JSON格式，包含预测的下一状态、各状态的预测概率、状态转移概率矩阵及状态空间列表
---

## 工作流程
1. **数据预处理**：将原始随机序列转换为有限离散的状态序列，确保状态定义清晰且无歧义。
2. **构建状态转移概率矩阵**：统计历史序列中所有状态间的转移频率，并归一化得到转移概率。
3. **确定初始状态**：获取当前时刻的状态作为预测的起始状态。
4. **执行预测计算**：利用转移概率矩阵计算当前状态下各可能下一状态的概率，选择概率最高的状态作为预测结果。
5. **结果输出**：返回预测状态、概率分布及转移矩阵等信息。

## 约束条件
- 序列必须满足马尔可夫性，即未来状态的概率分布仅依赖于当前状态，与过去的历史状态无关。
- 状态空间必须是有限且离散的，不支持连续值或无限状态的序列。
- 历史数据量需足够大，以保证状态转移概率矩阵的统计可靠性，避免因数据不足导致的概率偏差。
- 仅适用于短期状态预测，长期预测的误差会随预测步数增加而显著增大。

## 工具使用
马尔可夫链预测的核心实现代码位于`scripts/model.py`，可通过导入该模块中的`MarkovChainPredictor`类来使用。该类封装了状态转移矩阵构建、状态预测等功能，支持输入离散状态序列完成模型训练，并基于当前状态输出预测结果。